(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-397c27c4"],{"4c63":function(a,e,t){"use strict";t.r(e);var r=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",[t("el-tabs",{staticClass:"tabs",attrs:{type:"border-card"},model:{value:a.curTabPane,callback:function(e){a.curTabPane=e},expression:"curTabPane"}},a._l(a.chartList,(function(e){return t("el-tab-pane",{key:e.code,attrs:{label:e.label,name:e.code}},[a.curTabPane===e.code?t("div",[t("div",{staticClass:"chart-header"},[t("span",{staticClass:"text"},[a._v("时间范围")]),t("el-select",{attrs:{placeholder:"",size:"small"},on:{change:a.typeChangeHandle},model:{value:a.typeValue,callback:function(e){a.typeValue=e},expression:"typeValue"}},a._l(a.dateRangeOptions,(function(a){return t("el-option",{key:a.code,attrs:{label:a.label,value:a.code}})})),1),t("div",["custom"===a.typeValue?t("el-date-picker",{attrs:{type:"daterange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",size:"small"},on:{change:a.dataRangeChanged},model:{value:a.dateRange,callback:function(e){a.dateRange=e},expression:"dateRange"}}):a._e()],1)],1),t("MultiLineChart",{staticClass:"chart-container",attrs:{xData:a.xData,series:a.dataList}})],1):a._e()])})),1)],1)},n=[],i=t("b85c"),l=t("3835"),o=(t("fb6a"),t("d3b7"),t("159b"),t("caad"),t("2532"),t("ac1f"),t("5319"),t("7db0"),t("d81d"),t("4de4"),t("b0c0"),t("4ec9"),t("3ca3"),t("ddb0"),t("a630"),t("4e82"),t("00b4"),t("c1df")),s=t.n(o),c=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div")},u=[],d=t("22b4"),h=t("1be7"),f=t("2da7"),p=t("4b2a"),b=t("ff32"),v=t("3620"),g=t("c55a"),y=t("f95e");d["a"]([f["a"],p["a"],b["a"],v["a"],y["a"],g["a"]]);var m={props:{xData:{type:Array,required:!0},series:{type:Array,required:!0}},data:function(){return{}},watch:{xData:function(){this.showChart()},series:function(){this.showChart()}},mounted:function(){this.showChart()},methods:{showChart:function(){var a=[],e=this.series.map((function(e){var t=e.name,r=e.data,n="line";return a.push(t),{name:t,data:r,type:n}})),t={tooltip:{trigger:"axis"},legend:{data:a},grid:[{left:"5%",right:"5%",bottom:"10%"}],xAxis:{type:"category",data:this.xData},yAxis:{type:"value"},series:e};this.chart||(this.chart=h["b"](this.$el)),this.chart.setOption(t)}}},x=m,C=t("2877"),D=Object(C["a"])(x,c,u,!1,null,"68bf5970",null),w=D.exports,M=t("fc7d"),R=t("343d"),k={components:{MultiLineChart:w},mixins:[R["a"]],data:function(){return{chartList:[{code:"date",label:"日新增总体趋势"},{code:"age",label:"按年龄",group:[],groupMap:M["a"].covidDataUtil.ageGroup1,formatValue:this.formatAge},{code:"sex",label:"按性别",group:[],groupMap:[{id:1,label:"男",value:"男"},{id:2,label:"女",value:"女"}]},{code:"address",label:"按区域",group:[],groupMap:[{id:1,label:"福田区",value:""},{id:2,label:"南山区",value:""},{id:3,label:"宝安区",value:""},{id:4,label:"罗湖区",value:""},{id:5,label:"龙岗区",value:""},{id:6,label:"坪山区",value:""},{id:7,label:"龙华区",value:""},{id:8,label:"大鹏新区",value:""},{id:9,label:"坪山新区",value:""},{id:10,label:"光明新区",value:""}],formatValue:this.formatRegion}],curTabPane:"date",typeValue:"day3",title:"",xData:[],dataList:[],dateRangeOptions:[],dateRange:""}},props:{data:{type:Array}},watch:{curTabPane:function(a){this.showChart()}},mounted:function(){var a=this.totalTypeList.slice(1);a.forEach((function(a){a.label.includes("累计")&&(a.label="近".concat(a.label.replace("累计","日新增")))})),this.dateRangeOptions=a,this.showChart()},methods:{showChart:function(){var a=this;this.xData=[],this.dataList=[];var e,t,r=this.dateRangeOptions.find((function(e){return e.code===a.typeValue}));if("custom"===r.code){var n=Object(l["a"])(this.dateRange,2);e=n[0],t=n[1]}else t=s()(),e=s()().subtract(r.value,"day");this.createChartData(e,t,this.data)},createChartData:function(a,e,t){var r=this,n=this.filterMapDataByDateRange(a,e,this.data),i=this.chartList.find((function(a){return a.code===r.curTabPane}));"date"===i.code?this.groupByDate(n):this.group(a,e,n,i)},group:function(a,e,t,r){for(var n=this,i=s()(a),l=s()(e),o=l.diff(i,"day"),c=[i.format("YYYY-MM-DD")],u=0;u<o-1;u++){var d=i.add(1,"day");c.push(d.format("YYYY-MM-DD"))}var h=r.groupMap.map((function(a){return{name:a.label,type:"line",data:[]}}));c.map((function(a){var e=t.filter((function(e){return e.date===a})),i=n.createGroupByAge(e,r.code,r.groupMap,r.formatValue);i.forEach((function(a){var e=h.find((function(e){return e.name===a[0]}));e?e.data.push(a[1]):console.log(a[0])}))})),console.log("结构",h),this.xData=c,this.dataList=h},groupByDate:function(a){var e=this,t=new Map;a.forEach((function(a){var e=a.date,r=t.get(e)||0;t.set(e,r+1)}));var r=Array.from(t);r.sort((function(a,e){var t=s()(a[0]).format("X"),r=s()(e[0]).format("X");return t-r}));var n=[];r.forEach((function(a){e.xData.push(a[0]),n.push(a[1])})),this.dataList=[{type:"line",data:n,name:"日新增趋势",areaStyle:{}}]},typeChangeHandle:function(a){this.showChart()},createGroupByAge:function(a,e,t,r){var n=new Map;a.forEach((function(a){var l=a[e],o=r?r(l):l,s="";if(t){var c,u=Object(i["a"])(t);try{for(u.s();!(c=u.n()).done;){var d=c.value,h=d.id;if(h){var f=d.limit,p=d.value||d.label;if(Array.isArray(f)&&2===f.length){var b=parseInt(o);if("number"===typeof b&&b>f[0]&&b<=f[1]){s=h;break}}else if(p===o){s=h;break}}}}catch(g){u.e(g)}finally{u.f()}if(s){var v=n.get(s);v=v?v+1:1,n.set(s,v)}}}));var l=t.map((function(a){var e=a.label,t=n.get(a.id)||0;return[e,t]}));return l},formatAge:function(a){var e=/^\d+(?=月龄$)/,t=/^\d+(?=岁)/;return e.test(a)?e.exec(a)[0]:t.test(a)?t.exec(a)[0]:""},formatRegion:function(a){var e=/^.{2,}(?=区)/;return e.test(a)?e.exec(a)[0]+"区":""},dataRangeChanged:function(){this.showChart()}}},A=k,L=(t("820c"),Object(C["a"])(A,r,n,!1,null,"06b613da",null));e["default"]=L.exports},"820c":function(a,e,t){"use strict";t("cd3f")},cd3f:function(a,e,t){}}]);