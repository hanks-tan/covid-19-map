{"version":3,"sources":["webpack:///./src/views/shenzhen/TrendChart.vue?f955","webpack:///./src/components/charts/MultiLineChart.vue?122f","webpack:///src/components/charts/MultiLineChart.vue","webpack:///./src/components/charts/MultiLineChart.vue?9b51","webpack:///./src/components/charts/MultiLineChart.vue","webpack:///src/views/shenzhen/TrendChart.vue","webpack:///./src/views/shenzhen/TrendChart.vue?8330","webpack:///./src/views/shenzhen/TrendChart.vue","webpack:///./src/views/shenzhen/TrendChart.vue?1291"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","model","value","callback","$$v","curTabPane","expression","_l","item","key","code","label","_v","on","typeChangeHandle","typeValue","type","dataRangeChanged","dateRange","_e","xData","dataList","staticRenderFns","echarts","TooltipComponent","GridComponent","LegendComponent","LineChart","CanvasRenderer","UniversalTransition","props","required","series","data","watch","showChart","mounted","methods","lineNames","name","tooltip","trigger","legend","grid","left","right","bottom","xAxis","yAxis","chart","$el","setOption","option","component","components","MultiLineChart","mixins","chartList","group","groupMap","formatValue","id","title","dateRangeOptions","val","includes","totalType","start","end","createChartData","startDate","endData","opt","groupByDate","targetData","endDate","options","dateList","d","date","g","console","dataArr","groupArr","atime","btime","areaStyle","createGroupByAge","field","valueRangeMap","valueFunc","thisKey","count","groupData","groupList","formatAge","ageStr","reg1","test","exec","reg2","formatRegion","region","reg"],"mappings":"yHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,UAAU,CAACE,YAAY,OAAOC,MAAM,CAAC,KAAO,eAAeC,MAAM,CAACC,MAAOT,EAAc,WAAEU,SAAS,SAAUC,GAAMX,EAAIY,WAAWD,GAAKE,WAAW,eAAeb,EAAIc,GAAId,EAAa,WAAE,SAASe,GAAM,OAAOX,EAAG,cAAc,CAACY,IAAID,EAAKE,KAAKV,MAAM,CAAC,MAAQQ,EAAKG,MAAM,KAAOH,EAAKE,OAAO,CAAEjB,EAAIY,aAAeG,EAAKE,KAAMb,EAAG,MAAM,CAACA,EAAG,MAAM,CAACE,YAAY,gBAAgB,CAACF,EAAG,OAAO,CAACE,YAAY,QAAQ,CAACN,EAAImB,GAAG,UAAUf,EAAG,YAAY,CAACG,MAAM,CAAC,YAAc,GAAG,KAAO,SAASa,GAAG,CAAC,OAASpB,EAAIqB,kBAAkBb,MAAM,CAACC,MAAOT,EAAa,UAAEU,SAAS,SAAUC,GAAMX,EAAIsB,UAAUX,GAAKE,WAAW,cAAcb,EAAIc,GAAId,EAAoB,kBAAE,SAASuB,GAAM,OAAOnB,EAAG,YAAY,CAACY,IAAIO,EAAKN,KAAKV,MAAM,CAAC,MAAQgB,EAAKL,MAAM,MAAQK,EAAKN,WAAU,GAAGb,EAAG,MAAM,CAAoB,WAAlBJ,EAAIsB,UAAwBlB,EAAG,iBAAiB,CAACG,MAAM,CAAC,KAAO,YAAY,MAAQ,QAAQ,gBAAgB,GAAG,kBAAkB,IAAI,oBAAoB,OAAO,kBAAkB,OAAO,KAAO,SAASa,GAAG,CAAC,OAASpB,EAAIwB,kBAAkBhB,MAAM,CAACC,MAAOT,EAAa,UAAEU,SAAS,SAAUC,GAAMX,EAAIyB,UAAUd,GAAKE,WAAW,eAAeb,EAAI0B,MAAM,IAAI,GAAGtB,EAAG,iBAAiB,CAACE,YAAY,kBAAkBC,MAAM,CAAC,MAAQP,EAAI2B,MAAM,OAAS3B,EAAI4B,aAAa,GAAG5B,EAAI0B,UAAS,IAAI,IAC5yCG,EAAkB,G,yNCDlB,EAAS,WAAa,IAAI7B,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,QAC/F,EAAkB,G,gGCetB0B,OAAYA,CACZC,OACAC,OACAC,OACAC,OACAC,OACAC,SAGe,OACbC,MAAOA,CACLV,MAAOA,CACLJ,KAAMA,MACNe,UAAUA,GAEZC,OAAQA,CACNhB,KAAMA,MACNe,UAAUA,IAGdE,KAXF,WAYI,MAAO,IAITC,MAAOA,CACLd,MADJ,WAEM1B,KAAKyC,aAEPH,OAJJ,WAKMtC,KAAKyC,cAGTC,QAxBF,WAyBI1C,KAAKyC,aAEPE,QAASA,CACPF,UADJ,WAEM,IAAN,KACA,+BACQ,IAAR,kBACA,SAEQ,OADAG,EAAUA,KAAKA,GACR,CACLC,KAAVA,EACUN,KAAVA,EACUjB,KAAVA,MAIA,GACQwB,QAASA,CACPC,QAASA,QAEXC,OAAQA,CACNT,KAAMA,GAERU,KAAMA,CACd,CACUC,KAAVA,KACUC,MAAVA,KACUC,OAAVA,QAGQC,MAAOA,CACL/B,KAAMA,WACNiB,KAAMA,KAAKA,OAEbe,MAAOA,CACLhC,KAAMA,SAERgB,OAAQA,GAGLtC,KAAKuD,QACRvD,KAAKuD,MAAQ1B,EAAA,KAAa7B,KAAKwD,MAEjCxD,KAAKuD,MAAME,UAAUC,MC7F4U,I,YCOnWC,EAAY,eACd,EACA,EACA,GACA,EACA,KACA,WACA,MAIa,EAAAA,E,gCCoCA,GACbC,WAAYA,CACVC,eAAJA,GAEEC,OAAQA,CAACA,QACTvB,KALF,WAMI,MAAO,CACLwB,UAAWA,CACjB,CACQ/C,KAARA,OACQC,MAARA,WAEA,CACQD,KAARA,MACQC,MAARA,MACQ+C,MAARA,GACQC,SAARA,+BACQC,YAARA,gBAEA,CACQlD,KAARA,MACQC,MAARA,MACQ+C,MAARA,GACQC,SAARA,CACA,CAAUE,GAAVA,EAAUlD,MAAVA,IAAUT,MAAVA,KACA,CAAU2D,GAAVA,EAAUlD,MAAVA,IAAUT,MAAVA,OAGA,CACQQ,KAARA,UACQC,MAARA,MACQ+C,MAARA,GACQC,SAARA,CACA,CAAUE,GAAVA,EAAUlD,MAAVA,MAAUT,MAAVA,IACA,CAAU2D,GAAVA,EAAUlD,MAAVA,MAAUT,MAAVA,IACA,CAAU2D,GAAVA,EAAUlD,MAAVA,MAAUT,MAAVA,IACA,CAAU2D,GAAVA,EAAUlD,MAAVA,MAAUT,MAAVA,IACA,CAAU2D,GAAVA,EAAUlD,MAAVA,MAAUT,MAAVA,IACA,CAAU2D,GAAVA,EAAUlD,MAAVA,MAAUT,MAAVA,IACA,CAAU2D,GAAVA,EAAUlD,MAAVA,MAAUT,MAAVA,IACA,CAAU2D,GAAVA,EAAUlD,MAAVA,OAAUT,MAAVA,IACA,CAAU2D,GAAVA,EAAUlD,MAAVA,OAAUT,MAAVA,IACA,CAAU2D,GAAVA,GAAUlD,MAAVA,OAAUT,MAAVA,KAEQ0D,YAARA,oBAGMvD,WAAYA,OACZU,UAAWA,OACX+C,MAAOA,GACP1C,MAAOA,GACPC,SAAUA,GACV0C,iBAAkBA,GAClB7C,UAAWA,KAGfY,MAAOA,CACLG,KAAMA,CACJjB,KAAMA,QAGVkB,MAAOA,CACL7B,WADJ,SACA2D,GACMtE,KAAKyC,cAGTC,QAlEF,WAmEI,IAAJ,8BACI2B,EAAiBA,SAAQA,SAA7BA,GACUvD,EAAKG,MAAMsD,SAAS,QACtBzD,EAAKA,MAAQA,IAArBA,wCAGId,KAAKqE,iBAAmBA,EACxBrE,KAAKyC,aAEPE,QAASA,CACPF,UADJ,WACA,WACMzC,KAAK0B,MAAQ,GACb1B,KAAK2B,SAAW,GAChB,IACN,IADA,yEAEM,GAAuB,WAAnB6C,EAAUxD,KAAmB,CAAvC,qBACA,eADA,GACQyD,EADR,KACQC,EADR,UAGQA,EAAMA,MACND,EAAQA,MAASA,SAASA,EAAUA,MAAOA,OAE7CzE,KAAK2E,gBAAgBF,EAAOC,EAAK1E,KAAKuC,OAExCoC,gBAdJ,SAcAC,EAAAC,EAAAtC,GAAA,WACA,+CACA,mEACuB,SAAbuC,EAAI9D,KACNhB,KAAK+E,YAAYC,GAEjBhF,KAAKgE,MAAMY,EAAWC,EAASG,EAAYF,IAG/Cd,MAvBJ,SAuBAY,EAAAK,EAAA1C,EAAA2C,GAKM,IALN,WACA,SACA,SACA,kBACA,2BACA,eACQ,IAAR,iBACQC,EAASA,KAAKA,EAAKA,OAAOA,eAG5B,IAAN,8BACQ,MAAO,CACLtC,KAAMA,EAAKA,MACXvB,KAAMA,OACNiB,KAAMA,OAIV4C,EAASA,KAAIA,SAAnBA,GACQ,IAAR,wBACU,OAAOC,EAAEC,OAASA,KAG5B,wDACQrB,EAAMA,SAAQA,SAAtBA,GACU,IAAV,8CACcsB,EACFA,EAAEA,KAAKA,KAAKA,EAAKA,IAEjBC,QAAQA,IAAIA,EAAKA,UAKvBA,QAAQA,IAAIA,KAAMA,GAClBvF,KAAK0B,MAAQyD,EACbnF,KAAK2B,SAAW6D,GAElBT,YA7DJ,SA6DAxC,GAAA,WACA,UACMA,EAAKA,SAAQA,SAAnBA,GACQ,IAAR,SACA,cACQ0B,EAASA,IAAIA,EAAKA,EAAQA,MAE5B,IAAN,gBACMwB,EAASA,MAAKA,SAApBA,KACQ,IAAR,wBACA,wBACQ,OAAOC,EAAQC,KAGjB,IAAN,KACMF,EAASA,SAAQA,SAAvBA,GACQ,EAAR,iBACQ9D,EAASA,KAAKA,EAAKA,OAErB3B,KAAK2B,SAAW,CAAC,CACfL,KAAMA,OACNiB,KAAMA,EACNM,KAAMA,QACN+C,UAAWA,MAGfxE,iBAvFJ,SAuFAkD,GACMtE,KAAKyC,aAKPoD,iBA7FJ,SA6FAtD,EAAAuD,EAAAC,EAAAC,GACM,IAAN,UACMzD,EAAKA,SAAQA,SAAnBA,GACQ,IAAR,OACA,WACA,KACQ,GAAIwD,EAAe,CAA3B,uBACAA,GADA,IACA,0CACA,OACA,MAIA,cACA,mBACA,mCACA,kBACA,yCACAE,IACA,YAGA,UACAA,IACA,SAlBA,8BAuBU,GAAIA,EAAS,CACX,IAAZ,WACYC,EAAQA,EAAQA,EAAQA,EAAIA,EAC5BC,EAAUA,IAAIA,EAASA,QAK7B,IAAN,qBACQ,IAAR,UACA,iBACQ,MAAO,CAAClF,EAAOT,MAGjB,OAAO4F,GAETC,UA1IJ,SA0IAC,GACM,IAAN,gBACA,cACM,OAAIC,EAAKC,KAAKF,GACLC,EAAKE,KAAKH,GAAQ,GACjC,UACeI,EAAKD,KAAKH,GAAQ,GAEpB,IAETK,aApJJ,SAoJAC,GACM,IAAN,gBACM,OAAIC,EAAIL,KAAKI,GACJC,EAAIJ,KAAKG,GAAQ,GAAK,IAEtB,IAGXrF,iBA5JJ,WA6JMvB,KAAKyC,eC/RwV,ICQ/V,G,UAAY,eACd,EACA3C,EACA8B,GACA,EACA,KACA,WACA,OAIa,e,6CCnBf,W","file":"assets/js/chunk-397c27c4.bac942bd.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('el-tabs',{staticClass:\"tabs\",attrs:{\"type\":\"border-card\"},model:{value:(_vm.curTabPane),callback:function ($$v) {_vm.curTabPane=$$v},expression:\"curTabPane\"}},_vm._l((_vm.chartList),function(item){return _c('el-tab-pane',{key:item.code,attrs:{\"label\":item.label,\"name\":item.code}},[(_vm.curTabPane === item.code)?_c('div',[_c('div',{staticClass:\"chart-header\"},[_c('span',{staticClass:\"text\"},[_vm._v(\"时间范围\")]),_c('el-select',{attrs:{\"placeholder\":\"\",\"size\":\"small\"},on:{\"change\":_vm.typeChangeHandle},model:{value:(_vm.typeValue),callback:function ($$v) {_vm.typeValue=$$v},expression:\"typeValue\"}},_vm._l((_vm.dateRangeOptions),function(type){return _c('el-option',{key:type.code,attrs:{\"label\":type.label,\"value\":type.code}})}),1),_c('div',[(_vm.typeValue === 'custom')?_c('el-date-picker',{attrs:{\"type\":\"daterange\",\"align\":\"right\",\"unlink-panels\":\"\",\"range-separator\":\"至\",\"start-placeholder\":\"开始日期\",\"end-placeholder\":\"结束日期\",\"size\":\"small\"},on:{\"change\":_vm.dataRangeChanged},model:{value:(_vm.dateRange),callback:function ($$v) {_vm.dateRange=$$v},expression:\"dateRange\"}}):_vm._e()],1)],1),_c('MultiLineChart',{staticClass:\"chart-container\",attrs:{\"xData\":_vm.xData,\"series\":_vm.dataList}})],1):_vm._e()])}),1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div')}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport * as echarts from 'echarts/core'\r\nimport {\r\n  TooltipComponent,\r\n  GridComponent,\r\n  LegendComponent\r\n} from 'echarts/components'\r\nimport { LineChart } from 'echarts/charts'\r\nimport { UniversalTransition } from 'echarts/features'\r\nimport { CanvasRenderer } from 'echarts/renderers'\r\necharts.use([\r\n  TooltipComponent,\r\n  GridComponent,\r\n  LegendComponent,\r\n  LineChart,\r\n  CanvasRenderer,\r\n  UniversalTransition\r\n])\r\n\r\nexport default {\r\n  props: {\r\n    xData: {\r\n      type: Array,\r\n      required: true\r\n    },\r\n    series: {\r\n      type: Array,\r\n      required: true\r\n    }\r\n  },\r\n  data () {\r\n    return {\r\n\r\n    }\r\n  },\r\n  watch: {\r\n    xData () {\r\n      this.showChart()\r\n    },\r\n    series () {\r\n      this.showChart()\r\n    }\r\n  },\r\n  mounted () {\r\n    this.showChart()\r\n  },\r\n  methods: {\r\n    showChart () {\r\n      const lineNames = []\r\n      const series = this.series.map((item) => {\r\n        const { name, data } = item\r\n        const type = 'line'\r\n        lineNames.push(name)\r\n        return {\r\n          name,\r\n          data,\r\n          type\r\n        }\r\n      })\r\n\r\n      const option = {\r\n        tooltip: {\r\n          trigger: 'axis'\r\n        },\r\n        legend: {\r\n          data: lineNames\r\n        },\r\n        grid: [\r\n          {\r\n            left: '5%',\r\n            right: '5%',\r\n            bottom: '10%'\r\n          }\r\n        ],\r\n        xAxis: {\r\n          type: 'category',\r\n          data: this.xData\r\n        },\r\n        yAxis: {\r\n          type: 'value'\r\n        },\r\n        series: series\r\n      }\r\n\r\n      if (!this.chart) {\r\n        this.chart = echarts.init(this.$el)\r\n      }\r\n      this.chart.setOption(option)\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MultiLineChart.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MultiLineChart.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MultiLineChart.vue?vue&type=template&id=68bf5970&scoped=true&\"\nimport script from \"./MultiLineChart.vue?vue&type=script&lang=js&\"\nexport * from \"./MultiLineChart.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"68bf5970\",\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <div>\r\n    <el-tabs type=\"border-card\"  v-model=\"curTabPane\" class=\"tabs\">\r\n      <el-tab-pane\r\n        v-for=\"item in chartList\"\r\n        :key=\"item.code\"\r\n        :label=\"item.label\"\r\n        :name=\"item.code\"\r\n        >\r\n        <!-- 图表区 -->\r\n        <div v-if=\"curTabPane === item.code\">\r\n          <!-- 头部 -->\r\n          <div class=\"chart-header\">\r\n            <span class=\"text\">时间范围</span>\r\n            <el-select v-model=\"typeValue\" placeholder=\"\" @change=\"typeChangeHandle\" size=\"small\">\r\n              <el-option\r\n                v-for=\"type in dateRangeOptions\"\r\n                :key=\"type.code\"\r\n                :label=\"type.label\"\r\n                :value=\"type.code\">\r\n              </el-option>\r\n            </el-select>\r\n            <div>\r\n              <el-date-picker\r\n                v-if=\"typeValue === 'custom'\"\r\n                v-model=\"dateRange\"\r\n                type=\"daterange\"\r\n                align=\"right\"\r\n                unlink-panels\r\n                range-separator=\"至\"\r\n                start-placeholder=\"开始日期\"\r\n                end-placeholder=\"结束日期\"\r\n                size=\"small\"\r\n                @change=\"dataRangeChanged\">\r\n              </el-date-picker>\r\n            </div>\r\n          </div>\r\n          <MultiLineChart\r\n            :xData=\"xData\"\r\n            :series=\"dataList\"\r\n            class=\"chart-container\"\r\n            >\r\n          </MultiLineChart>\r\n        </div>\r\n      </el-tab-pane>\r\n    </el-tabs>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport moment from 'moment'\r\nimport MultiLineChart from 'comps/charts/MultiLineChart.vue'\r\nimport mapUtil from 'utils/mapUtil'\r\nimport mixin from './mixin'\r\nexport default {\r\n  components: {\r\n    MultiLineChart\r\n  },\r\n  mixins: [mixin],\r\n  data () {\r\n    return {\r\n      chartList: [\r\n        {\r\n          code: 'date',\r\n          label: '日新增总体趋势'\r\n        },\r\n        {\r\n          code: 'age',\r\n          label: '按年龄',\r\n          group: [],\r\n          groupMap: mapUtil.covidDataUtil.ageGroup1,\r\n          formatValue: this.formatAge\r\n        },\r\n        {\r\n          code: 'sex',\r\n          label: '按性别',\r\n          group: [],\r\n          groupMap: [\r\n            { id: 1, label: '男', value: '男' },\r\n            { id: 2, label: '女', value: '女' }\r\n          ]\r\n        },\r\n        {\r\n          code: 'address',\r\n          label: '按区域',\r\n          group: [],\r\n          groupMap: [\r\n            { id: 1, label: '福田区', value: '' },\r\n            { id: 2, label: '南山区', value: '' },\r\n            { id: 3, label: '宝安区', value: '' },\r\n            { id: 4, label: '罗湖区', value: '' },\r\n            { id: 5, label: '龙岗区', value: '' },\r\n            { id: 6, label: '坪山区', value: '' },\r\n            { id: 7, label: '龙华区', value: '' },\r\n            { id: 8, label: '大鹏新区', value: '' },\r\n            { id: 9, label: '坪山新区', value: '' },\r\n            { id: 10, label: '光明新区', value: '' }\r\n          ],\r\n          formatValue: this.formatRegion\r\n        }\r\n      ],\r\n      curTabPane: 'date',\r\n      typeValue: 'day3',\r\n      title: '',\r\n      xData: [],\r\n      dataList: [],\r\n      dateRangeOptions: [],\r\n      dateRange: ''\r\n    }\r\n  },\r\n  props: {\r\n    data: {\r\n      type: Array\r\n    }\r\n  },\r\n  watch: {\r\n    curTabPane (val) {\r\n      this.showChart()\r\n    }\r\n  },\r\n  mounted () {\r\n    const dateRangeOptions = this.totalTypeList.slice(1)\r\n    dateRangeOptions.forEach((item) => {\r\n      if (item.label.includes('累计')) {\r\n        item.label = `近${item.label.replace('累计', '日新增')}`\r\n      }\r\n    })\r\n    this.dateRangeOptions = dateRangeOptions\r\n    this.showChart()\r\n  },\r\n  methods: {\r\n    showChart () {\r\n      this.xData = []\r\n      this.dataList = []\r\n      const totalType = this.dateRangeOptions.find((item) => item.code === this.typeValue)\r\n      let start, end\r\n      if (totalType.code === 'custom') {\r\n        [start, end] = this.dateRange\r\n      } else {\r\n        end = moment()\r\n        start = moment().subtract(totalType.value, 'day')\r\n      }\r\n      this.createChartData(start, end, this.data)\r\n    },\r\n    createChartData (startDate, endData, data) {\r\n      const targetData = this.filterMapDataByDateRange(startDate, endData, this.data)\r\n      const opt = this.chartList.find((item) => item.code === this.curTabPane)\r\n      if (opt.code === 'date') {\r\n        this.groupByDate(targetData)\r\n      } else {\r\n        this.group(startDate, endData, targetData, opt)\r\n      }\r\n    },\r\n    group (startDate, endDate, data, options) {\r\n      const start = moment(startDate)\r\n      const end = moment(endDate)\r\n      const dist = end.diff(start, 'day')\r\n      const dateList = [start.format('YYYY-MM-DD')]\r\n      for (let i = 0; i < dist - 1; i++) {\r\n        const date = start.add(1, 'day')\r\n        dateList.push(date.format('YYYY-MM-DD'))\r\n      }\r\n\r\n      const dataArr = options.groupMap.map((cate) => {\r\n        return {\r\n          name: cate.label,\r\n          type: 'line',\r\n          data: []\r\n        }\r\n      })\r\n\r\n      dateList.map((date) => {\r\n        const dataTheDate = data.filter((d) => {\r\n          return d.date === date\r\n        })\r\n\r\n        const group = this.createGroupByAge(dataTheDate, options.code, options.groupMap, options.formatValue)\r\n        group.forEach((item) => {\r\n          const g = dataArr.find((j) => j.name === item[0])\r\n          if (g) {\r\n            g.data.push(item[1])\r\n          } else {\r\n            console.log(item[0])\r\n          }\r\n        })\r\n      })\r\n\r\n      console.log('结构', dataArr)\r\n      this.xData = dateList\r\n      this.dataList = dataArr\r\n    },\r\n    groupByDate (data) {\r\n      const groupMap = new Map()\r\n      data.forEach((item) => {\r\n        const key = item.date\r\n        const count = groupMap.get(key) || 0\r\n        groupMap.set(key, count + 1)\r\n      })\r\n      const groupArr = Array.from(groupMap)\r\n      groupArr.sort((a, b) => {\r\n        const atime = moment(a[0]).format('X')\r\n        const btime = moment(b[0]).format('X')\r\n        return atime - btime\r\n      })\r\n\r\n      const dataList = []\r\n      groupArr.forEach((item) => {\r\n        this.xData.push(item[0])\r\n        dataList.push(item[1])\r\n      })\r\n      this.dataList = [{\r\n        type: 'line',\r\n        data: dataList,\r\n        name: '日新增趋势',\r\n        areaStyle: {}\r\n      }]\r\n    },\r\n    typeChangeHandle (val) {\r\n      this.showChart()\r\n    },\r\n    /**\r\n     * 返回一个二维数组，Array[Array[cate, value]]\r\n     */\r\n    createGroupByAge (data, field, valueRangeMap, valueFunc) {\r\n      const groupData = new Map()\r\n      data.forEach((item) => {\r\n        const fieldValue = item[field]\r\n        const formatValue = valueFunc ? valueFunc(fieldValue) : fieldValue\r\n        let thisKey = ''\r\n        if (valueRangeMap) {\r\n          for (const rangeObj of valueRangeMap) {\r\n            const key = rangeObj.id\r\n            if (!key) {\r\n              continue\r\n            }\r\n\r\n            const limit = rangeObj.limit\r\n            const value = rangeObj.value || rangeObj.label\r\n            if (Array.isArray(limit) && limit.length === 2) {\r\n              const v = parseInt(formatValue) // 注意，值必须能转换成数字\r\n              if (typeof v === 'number' && v > limit[0] && v <= limit[1]) {\r\n                thisKey = key\r\n                break\r\n              }\r\n            } else {\r\n              if (value === formatValue) {\r\n                thisKey = key\r\n                break\r\n              }\r\n            }\r\n          }\r\n\r\n          if (thisKey) {\r\n            let count = groupData.get(thisKey)\r\n            count = count ? count + 1 : 1\r\n            groupData.set(thisKey, count)\r\n          }\r\n        }\r\n      })\r\n\r\n      const groupList = valueRangeMap.map((item) => {\r\n        const label = item.label\r\n        const value = groupData.get(item.id) || 0\r\n        return [label, value]\r\n      })\r\n\r\n      return groupList\r\n    },\r\n    formatAge (ageStr) {\r\n      const reg1 = /^\\d+(?=月龄$)/\r\n      const reg2 = /^\\d+(?=岁)/\r\n      if (reg1.test(ageStr)) {\r\n        return reg1.exec(ageStr)[0]\r\n      } else if (reg2.test(ageStr)) {\r\n        return reg2.exec(ageStr)[0]\r\n      }\r\n      return ''\r\n    },\r\n    formatRegion (region) {\r\n      const reg = /^.{2,}(?=区)/\r\n      if (reg.test(region)) {\r\n        return reg.exec(region)[0] + '区'\r\n      } else {\r\n        return ''\r\n      }\r\n    },\r\n    dataRangeChanged () {\r\n      this.showChart()\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n@import url('../../assets/css/charts.less');\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrendChart.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrendChart.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./TrendChart.vue?vue&type=template&id=06b613da&scoped=true&\"\nimport script from \"./TrendChart.vue?vue&type=script&lang=js&\"\nexport * from \"./TrendChart.vue?vue&type=script&lang=js&\"\nimport style0 from \"./TrendChart.vue?vue&type=style&index=0&id=06b613da&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"06b613da\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrendChart.vue?vue&type=style&index=0&id=06b613da&lang=less&scoped=true&\""],"sourceRoot":""}